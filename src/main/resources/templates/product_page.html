<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Product page</title>

  <link rel="stylesheet" th:href="@{'https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css'}"
        integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l"
        crossorigin="anonymous">
<!--  <script th:src="@{'https://code.jquery.com/jquery-3.5.1.slim.min.js'}"-->
<!--          integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"-->
<!--          crossorigin="anonymous"></script>-->
<!--  <script th:src="@{'https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js'}"-->
<!--          integrity="sha384-Piv4xVNRyMGpqkS2by6br4gNJ7DXjqk09RmUpJ8jgGtD7zP9yug3goQfGII0yAns"-->
<!--          crossorigin="anonymous"></script>-->
</head>
<body>

<div class="row no-gutters vh-100">
  <!---------- Left Column / Image ---------->
  <div class="col-md-6 bg-light">
    <div class="product-image">
      <a href="">
         <img th:src= "${item.getImages()[0]}">
      </a>
    </div>
  </div>

  <!---------- Right Column ---------->
  <div class="col-md-6 bg-white">
    <br/>
    <p th:text="${shop.getName()}"><b>Название магазина</b></p>
    <br/>
    <div class="product-category">
      <p><b>Категории:</b></p>
      <ul th:each="category : ${item.getCategories()}">
        <li th:text="${category}"></li>
      </ul>
      <br/>
      <b th:text="${item.getName()}">Название товара</b>
      <div class="product-configuration">
        <hr/>
        <div class="product-description">
          <p th:text="${item.getDescription()}">Описание товара</p>
        </div>
        <hr/>
        <!-- Product Pricing -->
        <div class="product-price">
          <p th:text="${item.getPrice()}">Стоимость товара</p>
        </div>
        <div>
          <label for="itemQuant">Количество:</label>
          <input type="number" id="itemQuant" th:value="${cartItem!=null}?${cartItem.getQuantity()} :1" class="form-control" min="1">
        </div>
        <div class="form-group">
          <button class="btn btn-primary btn-block" th:attr="onclick=|addCartItem('${item.id}','${shop.id}')|">В корзину</button>
        </div>
      </div>
    </div>
  </div>
</div>
<script>
  async function addCartItem(itemId, shopId) {
    let quant = document.getElementById("itemQuant").value;
    let url = new URL("http://localhost:8888/api/cart/add")
    const response = await fetch(url, {
      method: 'POST',
      headers: {
        "Accept": "application/json",
        "Content-Type": "application/json; charset=utf-8",
      },
      body: JSON.stringify({
        quantity: quant,
        item: {
          id: itemId
        },
        shop: {
          id: shopId
        },
      })
    })
  }
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
</body>
</html>
